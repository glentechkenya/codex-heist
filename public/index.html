<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Codex Heist</title>

<style>
body{
  margin:0;
  background:#05060a;
  color:#00fff7;
  font-family: Arial, sans-serif;
  display:flex;
  flex-direction:column;
  height:100vh;
}

header{
  padding:14px;
  text-align:center;
  background:#000;
  border-bottom:1px solid #00fff7;
  box-shadow:0 0 15px rgba(0,255,247,.4);
}

#login, #main{
  flex:1;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  padding:20px;
}

.panel{
  width:100%;
  max-width:400px;
  background:#0b0f18;
  padding:20px;
  border-radius:12px;
  border:1px solid #00fff7;
  box-shadow:0 0 20px rgba(0,255,247,.4);
}

input{
  width:100%;
  padding:14px;
  margin-top:12px;
  background:#000;
  border:1px solid #00fff7;
  border-radius:20px;
  color:#00fff7;
}

button{
  width:100%;
  margin-top:15px;
  padding:14px;
  background:#00fff7;
  color:#000;
  border:none;
  border-radius:20px;
  font-weight:bold;
}

#main{
  display:none;
  justify-content:flex-start;
}

#messages{
  flex:1;
  width:100%;
  overflow-y:auto;
  padding:10px;
}

.msg{
  background:#111;
  padding:10px;
  border-radius:10px;
  margin-bottom:10px;
  max-width:80%;
}

.me{
  background:#00fff7;
  color:black;
  margin-left:auto;
}

.system{
  background:none;
  color:gray;
  text-align:center;
}

.input-bar{
  display:flex;
  width:100%;
  padding:10px;
  border-top:1px solid #00fff7;
}

.input-bar input{
  flex:1;
}

.input-bar button{
  width:auto;
  margin-left:8px;
}
</style>
</head>

<body>

<header>CODEX HEIST</header>

<div id="login">
  <div class="panel">
    <input id="name" placeholder="Codename">
    <input id="room" placeholder="Room">
    <button onclick="join()">Connect</button>
  </div>
</div>

<div id="main">
  <div id="messages"></div>
  <div class="input-bar">
    <input id="msg" placeholder="Type messageâ€¦">
    <button onclick="send()">Send</button>
  </div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();
let username, room;

function join(){
  username = document.getElementById("name").value;
  room = document.getElementById("room").value;
  if(!username || !room) return;

  socket.emit("join-room",{username,room});
  document.getElementById("login").style.display="none";
  document.getElementById("main").style.display="flex";
}

socket.on("message", function(msg){
  const messages = document.getElementById("messages");
  const div = document.createElement("div");

  if(msg.includes("joined") || msg.includes("left")){
    div.className="msg system";
    div.textContent=msg;
  }
  else if(msg.startsWith(username + ":")){
    div.className="msg me";
    div.textContent=msg.replace(username + ": ","");
  }
  else{
    div.className="msg";
    div.textContent=msg;
  }

  messages.appendChild(div);
  messages.scrollTop = messages.scrollHeight;
});

function send(){
  const input = document.getElementById("msg");
  if(!input.value) return;
  socket.emit("message", input.value);
  input.value="";
}
</script>

</body>
</html>
